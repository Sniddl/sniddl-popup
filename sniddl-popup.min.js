(function(){Function.prototype.property=function(t,e){return Object.defineProperty(this.prototype,t,e)},window.Popup=function(){function Popup(params){var _body,_but,_but_,_button,_buttons,_color,_current,_footer,_header,_this,_title,_tray,_window,headerDown,headerMove,headerUp,i,p,xpos,ypos;if(p=params||{},_this=this,this.appendTo=p.appendTo||"body",this.buttons=p.buttons||["Continue","Cancel"],this.closeable=p.closeable||!1,this.draggable=p.draggable||!1,p.el&&(this.el=p.el),this.genID=!0,this.pinnable=p.pinnable||!1,p.text&&(this.text=p.text),this.title=p.title||"Popup",_window=document.createElement("div"),_window.className="window",_window.id="popup-window-"+this.id,this.parent.appendChild(_window),this.setWindow=!0,this.show=!0,_tray=document.createElement("div"),_tray.id="popup-tray",document.body.appendChild(_tray),xpos=ypos=0,_header=document.createElement("div"),_header.className="header",_window.appendChild(_header),headerDown=function(t){return _this.draggable===!0?(xpos=t.clientX-_window.offsetLeft,ypos=t.clientY-_window.offsetTop,window.addEventListener("mousemove",headerMove,!0)):void 0},headerMove=function(t){return _this.minimize=!1,parseInt(_window.style.top)+_window.clientHeight>window.innerHeight+50&&_this.pinnable===!0&&(_this.minimize=!0),_window.style.position="absolute",_window.style.top=t.clientY+"px",_window.style.left=t.clientX+"px"},headerUp=function(){return window.removeEventListener("mousemove",headerMove,!0)},_header.addEventListener("mousedown",headerDown,!1),window.addEventListener("mouseup",headerUp,!1),this.closeable===!0)for(_buttons=document.createElement("div"),_buttons.className="buttons",_header.appendChild(_buttons),_color=["red","yellow","green"],i=0;3>i;)_button=document.createElement("button"),_button.className="button ",_button.className+=_color[i],_button.id=_but_="popup-"+_color[i]+"-"+this.id,_buttons.appendChild(_button),_but=document.getElementById(_but_),"red"===_color[i]?_button.addEventListener("click",function(){return _this.show=!1},_this):"yellow"===_color[i]?_button.addEventListener("click",function(){return _this.minimize=!0},_this):_button.addEventListener("click",function(){return _this.minimize=!1},_this),i++;for(_title=document.createElement("div"),_title.className="title",_title.innerHTML=this.title,_header.appendChild(_title),_body=document.createElement("div"),_body.className="body",_body.innerHTML=this.body,_window.appendChild(_body),_footer=document.createElement("div"),_footer.className="footer",_window.appendChild(_footer),_buttons=document.createElement("div"),_buttons.className="buttons",_footer.appendChild(_buttons),i=0;i<Object.keys(this.actions).length;)_current=Object.keys(this.actions)[i],"default"!==_current&&(_button=document.createElement("button"),_button.className="button ",_button.id="popup-"+_current+"-"+this.id,_button.innerHTML=_current,_button.onClickMethod=_current,_buttons.appendChild(_button),_button.addEventListener("click",function(){return eval("if(p.on"+this.onClickMethod+"){p.on"+this.onClickMethod+"()}"),_this.show=!1},_this)),i++;_button=document.createElement("button"),_button.className="button ",_button.id="popup-default-"+this.id,_button.classList.add("default"),_button.addEventListener("click",function(){return p.onDefault&&p.onDefault(),_this.show=!1},_this),_button.innerHTML=this.actions["default"],_buttons.appendChild(_button)}return Popup.property("genID",{set:function(){return this.id=window.popup_incr=++window.popup_incr||1}}),Popup.property("show",{set:function(t){return t===!0?this.window.style.display="block":this.window.style.display="none",this.isVisible=t}}),Popup.property("minimize",{set:function(t){var e;return t===!0?(e=document.getElementById("popup-tray"),this.window.children[1].style.display="none",this.window.children[2].style.display="none",this.window.classList.add("minimized"),e.appendChild(this.window)):(this.window.children[1].style.display="block",this.window.children[2].style.display="block",this.window.classList.remove("minimized"),this.parent.appendChild(this.window)),this.isVisible=t}}),Popup.property("text",{set:function(t){return this.body=t}}),Popup.property("el",{set:function(t){return this.body=document.querySelector(t).outerHTML}}),Popup.property("setWindow",{set:function(){return this.window=document.getElementById("popup-window-"+this.id)}}),Popup.property("appendTo",{set:function(t){return this.parent=document.querySelector(t)}}),Popup.property("buttons",{set:function(buttons){var b,j,len,results;for(this.actions={},results=[],j=0,len=buttons.length;len>j;j++)b=buttons[j],0===buttons.indexOf(b)?results.push(this.actions["default"]=buttons[0]):results.push(eval("this.actions."+b+" = '"+b+"'"));return results}}),Popup}()}).call(this);
